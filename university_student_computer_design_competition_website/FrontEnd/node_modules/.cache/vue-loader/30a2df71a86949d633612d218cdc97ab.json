{"remainingRequest":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Message/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Message/index.vue","mtime":1646304196260},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/babel-loader/lib/index.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js","mtime":1642048410000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0UmVxdWVzdCwgcG9zdFJlcXVlc3R9IGZyb20gIkAvdXRpbHMvYXBpIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWVzc2FnZSIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhcmFtczoge30sCiAgICAgIC8vIGNvbnRlc3RJZDonJywKICAgICAgLy8gY29udGVzdFRpdGxlOicnLAogICAgICBkYXRhOiBbXSwKICAgICAgbXVsdGlwbGVTZWxlY3Rpb246IFtdLAogICAgICB0aXRsZTogJycsCiAgICAgIHRleHQ6ICcnCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5wYXJhbXMgPSB0aGlzLiRyb3V0ZS5wYXJhbXM7CiAgICBnZXRSZXF1ZXN0KCIvc2NvcmVzL3VzZXJzIiwge2NpZDogdGhpcy5wYXJhbXMuY29udGVzdElkfSkudGhlbigocmVzKSA9PiB7CiAgICAgIHRoaXMuZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLmRhdGEpOwogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVNlbGVjdGlvbkNoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbiA9IFtdOwogICAgICBjb25zdCBzZW5kZXIgPSB0aGlzLiRzdG9yZS5zdGF0ZS51aWQ7CiAgICAgIHZhbC5mb3JFYWNoKCh2YWwpID0+IHsKICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uLnB1c2goe3JlY2lwaWVudDogdmFsLnVzZXJJZCwgc2VuZGVyOiBzZW5kZXJ9KTsKICAgICAgfSk7CiAgICB9LAogICAgc2VuZCgpIHsKICAgICAgbGV0IGxlbmd0aCA9IHRoaXMubXVsdGlwbGVTZWxlY3Rpb24ubGVuZ3RoCiAgICAgIGlmIChsZW5ndGggJiYgdGhpcy50aXRsZS50cmltKCkgIT09ICcnICYmIHRoaXMudGV4dC50cmltKCkgIT09ICcnKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgdGhpcy4kc2V0KHRoaXMubXVsdGlwbGVTZWxlY3Rpb25baV0sICd0aXRsZScsIHRoaXMudGl0bGUpOwogICAgICAgICAgdGhpcy4kc2V0KHRoaXMubXVsdGlwbGVTZWxlY3Rpb25baV0sICd0ZXh0JywgdGhpcy50ZXh0KTsKICAgICAgICB9CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5tdWx0aXBsZVNlbGVjdGlvbik7CiAgICAgICAgcG9zdFJlcXVlc3QoIi9tZXNzYWdlcy9zYXZlIiwgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbikudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YS5kYXRhKTsKICAgICAgICAgIGlmIChyZXMuZGF0YS5kYXRhKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Y+R6YCB5oiQ5Yqf44CCIikKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuWPkemAgeWksei0pe+8gSIpCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCLor7flnKjlt6bkvqfli77pgInlrabnlJ/miJbmo4DmtYvmoIfpopjlhoXlrrnmmK/lkKbkuLrnqbrvvIEiKQogICAgICB9CiAgICB9LAogICAgZ28oZGF0YSkgewogICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdGhpcy5wYXJhbXMubmFtZSA9IGRhdGEubmFtZTsKICAgICAgdGhpcy5wYXJhbXMuc2NvcmVzSWQgPSBkYXRhLnNjb3Jlc0lkOwogICAgICB0aGlzLnBhcmFtcy5waG9uZSA9IGRhdGEucGhvbmU7CiAgICAgIHRoaXMucGFyYW1zLnNjaG9vbCA9IGRhdGEuc2Nob29sOwogICAgICB0aGlzLnBhcmFtcy51c2VySWQgPSBkYXRhLnVzZXJJZDsKICAgICAgdGhpcy5wYXJhbXMuc3RhdGUgPSBkYXRhLnN0YXRlOwogICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnBhcmFtcyk7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAnbWFuYWdlbWVudC1zY29yZScsIHBhcmFtczogdGhpcy5wYXJhbXN9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/layout/Main/Management/Message","sourcesContent":["<template>\n  <div>\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\" :offset=\"4\">\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span style=\"line-height: 28px;font-size: 20px\">发送消息请先选中</span>\n            <el-button style=\"float: right\" size=\"mini\" type=\"primary\" round @click=\"$router.push('/management')\">\n              返回\n            </el-button>\n          </div>\n          <el-table :data=\"data\" @selection-change=\"handleSelectionChange\" fit>\n            <el-table-column type=\"selection\"></el-table-column>\n            <el-table-column prop=\"name\" label=\"姓名\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"school\" label=\"学校\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"phone\" label=\"手机号\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"state\" label=\"评审状态\" align=\"center\">\n              <template v-slot=\"scope\">\n                <el-tag :type=\"scope.row.state ? 'danger' : 'success'\" disable-transitions>\n                  {{ scope.row.state ? '已评审' : '未评审' }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column fixed=\"right\" label=\"操作\" width=\"100%\" align=\"center\">\n              <template v-slot=\"scope\">\n                <el-button type=\"text\" size=\"small\" @click=\"go(scope.row)\">\n                  {{ scope.row.state ? '查看' : '评审' }}\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-card>\n      </el-col>\n      <el-col :span=\"4\">\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span style=\"line-height: 28px;font-size: 20px\">发送消息</span>\n          </div>\n          <el-form label-position=\"top\">\n            <el-form-item label=\"标题\" prop=\"title\">\n              <el-input placeholder=\"请输入标题\" v-model=\"title\" maxlength=\"20\" show-word-limit\n                        :rules=\"[{ required: true, message: '标题不能为空'}]\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"内容\" prop=\"text\">\n              <el-input type=\"textarea\" :rows=\"5\" placeholder=\"请输入内容\" v-model=\"text\"\n                        :rules=\"[{ required: true, message: '内容不能为空'}]\"></el-input>\n            </el-form-item>\n            <el-form-item style=\"float: right\">\n              <el-button type=\"primary\" round @click=\"send\">发送</el-button>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport {getRequest, postRequest} from \"@/utils/api\";\n\nexport default {\n  name: \"Message\",\n  data() {\n    return {\n      params: {},\n      // contestId:'',\n      // contestTitle:'',\n      data: [],\n      multipleSelection: [],\n      title: '',\n      text: ''\n    }\n  },\n  mounted() {\n    this.params = this.$route.params;\n    getRequest(\"/scores/users\", {cid: this.params.contestId}).then((res) => {\n      this.data = res.data.data;\n      console.log(res.data.data);\n    })\n  },\n  methods: {\n    handleSelectionChange(val) {\n      this.multipleSelection = [];\n      const sender = this.$store.state.uid;\n      val.forEach((val) => {\n        this.multipleSelection.push({recipient: val.userId, sender: sender});\n      });\n    },\n    send() {\n      let length = this.multipleSelection.length\n      if (length && this.title.trim() !== '' && this.text.trim() !== '') {\n        for (let i = 0; i < length; i++) {\n          this.$set(this.multipleSelection[i], 'title', this.title);\n          this.$set(this.multipleSelection[i], 'text', this.text);\n        }\n        // console.log(this.multipleSelection);\n        postRequest(\"/messages/save\", this.multipleSelection).then((res) => {\n          console.log(res.data.data);\n          if (res.data.data) {\n            this.$message.success(\"发送成功。\")\n          } else {\n            this.$message.error(\"发送失败！\")\n          }\n        });\n      } else {\n        this.$message.warning(\"请在左侧勾选学生或检测标题内容是否为空！\")\n      }\n    },\n    go(data) {\n      // console.log(data);\n      this.params.name = data.name;\n      this.params.scoresId = data.scoresId;\n      this.params.phone = data.phone;\n      this.params.school = data.school;\n      this.params.userId = data.userId;\n      this.params.state = data.state;\n      // console.log(this.params);\n      this.$router.push({name: 'management-score', params: this.params})\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}