{"remainingRequest":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Score/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Score/index.vue","mtime":1646135594470},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/babel-loader/lib/index.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js","mtime":1642048410000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0UmVxdWVzdCwgcG9zdFJlcXVlc3QsIHB1dFJlcXVlc3R9IGZyb20gIkAvdXRpbHMvYXBpIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU2NvcmUiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbnB1dERpc2FibGVkOiB0cnVlLAogICAgICBkYXRhOiB7CiAgICAgICAgY29udGVzdFRpdGxlOiAnJywKICAgICAgICBzY29yZXNJZDogJycsCiAgICAgICAgbmFtZTogJycsCiAgICAgICAgcGhvbmU6ICcnLAogICAgICAgIHNjaG9vbDogJycsCiAgICAgICAgc3RhdGU6ICcnLAogICAgICAgIHJhbmtpbmc6ICcnLAogICAgICAgIGp1ZGdlOiAnJywKICAgICAgICByZXN1bHQ6ICcnLAogICAgICAgIHRleHQ6ICcnLAogICAgICAgIHVzZXJJZDogJycKICAgICAgfSwKICAgICAgc3VibWl0RGF0YTogewogICAgICAgIHNjb3Jlc0lkOiAnJywKICAgICAgICBqdWRnZTogJycsCiAgICAgICAgcmVzdWx0OiAnJywKICAgICAgICBzdGF0ZTogdHJ1ZSwKICAgICAgICB0ZXh0OiAnJwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5kYXRhID0gdGhpcy4kcm91dGUucGFyYW1zOwogICAgdGhpcy5zY29yZUxvYWRpbmcodGhpcy5kYXRhLnNjb3Jlc0lkKTsKICAgIC8vIGdldFJlcXVlc3QoIi9jb250ZXN0cy9naWQiLCB7Z2lkOiBzZXNzaW9uU3RvcmFnZS5naWR9KS50aGVuKChyZXMpID0+IHsKICAgIC8vICAgdGhpcy5kYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgIC8vICAgY29uc29sZS5sb2codGhpcy5kYXRhKQogICAgLy8gfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOWKoOi9vQogICAgc2NvcmVMb2FkaW5nKGlkKSB7CiAgICAgIC8vIOagueaNrmlk5p+l6K+iCiAgICAgIGlmICh0aGlzLmRhdGEuc3RhdGUpIHsKICAgICAgICBnZXRSZXF1ZXN0KCIvc2NvcmVzLyIgKyBpZCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBjb25zdCBkYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmRhdGEsICdyYW5raW5nJywgZGF0YS5yYW5raW5nID09PSB1bmRlZmluZWQgPyAn5pyq55+lJyA6IGRhdGEucmFua2luZyk7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5kYXRhLCAnanVkZ2UnLCBkYXRhLmp1ZGdlKTsKICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmRhdGEsICdyZXN1bHQnLCBkYXRhLnJlc3VsdCk7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5kYXRhLCAndGV4dCcsIGRhdGEudGV4dCk7CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlucHV0RGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLmRhdGEuanVkZ2UgPSB0aGlzLmRhdGEucmFua2luZyA9ICfmmoLml6AnOwogICAgICB9CiAgICB9LAogICAgLy8g5L+u5pS5CiAgICBzY29yZU1vZGlmeSgpIHsKICAgICAgdGhpcy5pbnB1dERpc2FibGVkID0gIXRoaXMuaW5wdXREaXNhYmxlZDsKICAgIH0sCiAgICAvLyDor4TlrqEKICAgIHNjb3JlUmV2aWV3KCkgewogICAgICBsZXQgcmVzdWx0ID0gcGFyc2VJbnQodGhpcy5kYXRhLnJlc3VsdCk7CiAgICAgIGlmIChyZXN1bHQgPiAxMDAgfHwgcmVzdWx0IDwgMSB8fCBpc05hTihyZXN1bHQpKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5YiG5pWw5Y+q6IO95ZyoMC0xMDDkuYvpl7TvvIEnKQogICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YS50ZXh0ID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfor4Tor63kuI3og73kuLrnqbrvvIEnKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3VibWl0RGF0YS5zY29yZXNJZCA9IHRoaXMuZGF0YS5zY29yZXNJZDsKICAgICAgICB0aGlzLnN1Ym1pdERhdGEuanVkZ2UgPSBOdW1iZXIodGhpcy4kc3RvcmUuc3RhdGUudWlkKTsKICAgICAgICB0aGlzLnN1Ym1pdERhdGEucmVzdWx0ID0gcmVzdWx0OwogICAgICAgIHRoaXMuc3VibWl0RGF0YS50ZXh0ID0gdGhpcy5kYXRhLnRleHQ7CiAgICAgICAgdGhpcy5pbnB1dERpc2FibGVkID0gIXRoaXMuaW5wdXREaXNhYmxlZDsKICAgICAgICAvLyDkv67mlLnmlbDmja4KICAgICAgICBwdXRSZXF1ZXN0KCIvc2NvcmVzL3VwZGF0ZSIsdGhpcy5zdWJtaXREYXRhKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGlmIChyZXMuZGF0YS5kYXRhKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi6K+E5a6h5oiQ5Yqf44CCIikKICAgICAgICAgICAgLy8g5Y+R6YCB6YCa55+lCiAgICAgICAgICAgIHRoaXMubWVzc2FnZSgpOwogICAgICAgICAgICB0aGlzLmRhdGEuc3RhdGUgPSB0cnVlOwogICAgICAgICAgICB0aGlzLnNjb3JlTG9hZGluZyh0aGlzLmRhdGEuc2NvcmVzSWQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+E5a6h5aSx6LSl77yBIikKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgbWVzc2FnZSgpIHsKICAgICAgbGV0IHRpdGxlID0gJyc7CiAgICAgIGxldCB0ZXh0ID0gJyc7CiAgICAgIGlmICh0aGlzLmRhdGEuc3RhdGUpIHsKICAgICAgICB0aXRsZSA9ICfmr5TotZvnu5PmnpzmlLnliqjpgJrnn6UnOwogICAgICAgIHRleHQgPSAn5oKo5oql5ZCN55qE5q+U6LWb77ya44CKJyArIHRoaXMuZGF0YS5jb250ZXN0VGl0bGUgKyAn44CL57uT5p6c5bey5L+u5pS544CCJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aXRsZSA9ICfmr5TotZvor4TlrqHlrozmiJDpgJrnn6UnOwogICAgICAgIHRleHQgPSAn5oGt5Zac5oKo5oql5ZCN55qE5q+U6LWb77ya44CKJyArIHRoaXMuZGF0YS5jb250ZXN0VGl0bGUgKyAn44CL5bey57uP6K+E5a6h5a6M5oiQ44CCJzsKICAgICAgfQogICAgICBjb25zdCBvYmogPSB7CiAgICAgICAgcmVjaXBpZW50OiB0aGlzLmRhdGEudXNlcklkLAogICAgICAgIHRpdGxlOiB0aXRsZSwKICAgICAgICB0ZXh0OiB0ZXh0LAogICAgICAgIHNlbmRlcjogTnVtYmVyKHRoaXMuJHN0b3JlLnN0YXRlLnVpZCkKICAgICAgfTsKICAgICAgcG9zdFJlcXVlc3QoIi9tZXNzYWdlcy9pbnNlcnQiLCBvYmopOwogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/layout/Main/Management/Score","sourcesContent":["<template>\n  <div style=\"margin-top: 10%;\">\n    <el-row :gutter=\"20\">\n      <el-col :span=\"10\" :offset=\"7\">\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span style=\"line-height: 28px;font-size: 20px\">{{ this.data.contestTitle }}</span>\n            <el-button style=\"float: right\" size=\"mini\" type=\"primary\" round\n                       @click=\"$router.push({name: 'management-message', params: {contestId:data.contestId,contestTitle:data.contestTitle}})\">\n              返回\n            </el-button>\n          </div>\n\n          <el-descriptions title=\"评审信息\" border :contentStyle=\"{'text-align': 'center'}\"\n                           :labelStyle=\"{'text-align': 'center'}\">\n            <el-descriptions-item label=\"用户名\">{{ data.name }}</el-descriptions-item>\n            <el-descriptions-item label=\"评审人\">{{ data.judge }}</el-descriptions-item>\n            <el-descriptions-item label=\"排名\">{{ data.ranking }}</el-descriptions-item>\n            <el-descriptions-item label=\"手机号\">{{ data.phone }}</el-descriptions-item>\n\n            <el-descriptions-item label=\"学校\">\n              <el-tag size=\"small\">{{ data.school }}</el-tag>\n            </el-descriptions-item>\n            <el-descriptions-item label=\"得分\">\n              <input :disabled=\"inputDisabled\" v-model=\"data.result\" maxlength=\"3\"\n                     onkeyup=\"value=value.replace(/[^\\d]/g,'')\"\n                     style=\"width: 30px;text-align: center\"></input>\n            </el-descriptions-item>\n            <el-descriptions-item label=\"评语\">\n              <textarea :disabled=\"inputDisabled\" v-model=\"data.text\" style=\"width: 100%;\"></textarea>\n            </el-descriptions-item>\n          </el-descriptions>\n          <div style=\"float: right;margin: 20px 0\">\n            <template v-if=\"inputDisabled\">\n              <el-button type=\"warning\" round @click=\"scoreModify\">修改</el-button>\n            </template>\n            <template v-else>\n              <el-button type=\"success\" round @click=\"scoreReview\">评审</el-button>\n              <el-button type=\"danger\" round @click=\"inputDisabled = !inputDisabled\">取消</el-button>\n            </template>\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport {getRequest, postRequest, putRequest} from \"@/utils/api\";\n\nexport default {\n  name: \"Score\",\n  data() {\n    return {\n      inputDisabled: true,\n      data: {\n        contestTitle: '',\n        scoresId: '',\n        name: '',\n        phone: '',\n        school: '',\n        state: '',\n        ranking: '',\n        judge: '',\n        result: '',\n        text: '',\n        userId: ''\n      },\n      submitData: {\n        scoresId: '',\n        judge: '',\n        result: '',\n        state: true,\n        text: ''\n      }\n    }\n  },\n  mounted() {\n    this.data = this.$route.params;\n    this.scoreLoading(this.data.scoresId);\n    // getRequest(\"/contests/gid\", {gid: sessionStorage.gid}).then((res) => {\n    //   this.data = res.data.data;\n    //   console.log(this.data)\n    // })\n  },\n  methods: {\n    // 加载\n    scoreLoading(id) {\n      // 根据id查询\n      if (this.data.state) {\n        getRequest(\"/scores/\" + id).then((res) => {\n          const data = res.data.data;\n          this.$set(this.data, 'ranking', data.ranking === undefined ? '未知' : data.ranking);\n          this.$set(this.data, 'judge', data.judge);\n          this.$set(this.data, 'result', data.result);\n          this.$set(this.data, 'text', data.text);\n        })\n      } else {\n        this.inputDisabled = false;\n        this.data.judge = this.data.ranking = '暂无';\n      }\n    },\n    // 修改\n    scoreModify() {\n      this.inputDisabled = !this.inputDisabled;\n    },\n    // 评审\n    scoreReview() {\n      let result = parseInt(this.data.result);\n      if (result > 100 || result < 1 || isNaN(result)) {\n        this.$message.error('分数只能在0-100之间！')\n      } else if (this.data.text === undefined) {\n        this.$message.error('评语不能为空！')\n      } else {\n        this.submitData.scoresId = this.data.scoresId;\n        this.submitData.judge = Number(this.$store.state.uid);\n        this.submitData.result = result;\n        this.submitData.text = this.data.text;\n        this.inputDisabled = !this.inputDisabled;\n        // 修改数据\n        putRequest(\"/scores/update\",this.submitData).then((res) => {\n          if (res.data.data) {\n            this.$message.success(\"评审成功。\")\n            // 发送通知\n            this.message();\n            this.data.state = true;\n            this.scoreLoading(this.data.scoresId);\n          } else {\n            this.$message.error(\"评审失败！\")\n          }\n        })\n      }\n    },\n    message() {\n      let title = '';\n      let text = '';\n      if (this.data.state) {\n        title = '比赛结果改动通知';\n        text = '您报名的比赛：《' + this.data.contestTitle + '》结果已修改。';\n      } else {\n        title = '比赛评审完成通知';\n        text = '恭喜您报名的比赛：《' + this.data.contestTitle + '》已经评审完成。';\n      }\n      const obj = {\n        recipient: this.data.userId,\n        title: title,\n        text: text,\n        sender: Number(this.$store.state.uid)\n      };\n      postRequest(\"/messages/insert\", obj);\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\ninput, textarea {\n  border: none;\n  outline: none;\n  background-color: #fff;\n  resize: none;\n}\n</style>"]}]}