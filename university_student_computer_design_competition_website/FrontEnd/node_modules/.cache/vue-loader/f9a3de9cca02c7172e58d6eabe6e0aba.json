{"remainingRequest":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Message/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/src/views/layout/Main/Management/Message/index.vue","mtime":1646137301360},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/babel-loader/lib/index.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1642048410000},{"path":"/Volumes/Code/Graduation_Design/university_student_computer_design_competition_website/FrontEnd/node_modules/vue-loader/lib/index.js","mtime":1642048410000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Z2V0UmVxdWVzdCwgcG9zdFJlcXVlc3R9IGZyb20gIkAvdXRpbHMvYXBpIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTWVzc2FnZSIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBhcmFtczoge30sCiAgICAgIC8vIGNvbnRlc3RJZDonJywKICAgICAgLy8gY29udGVzdFRpdGxlOicnLAogICAgICBkYXRhOiBbXSwKICAgICAgbXVsdGlwbGVTZWxlY3Rpb246IFtdLAogICAgICB0aXRsZTogJycsCiAgICAgIHRleHQ6ICcnCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5wYXJhbXMgPSB0aGlzLiRyb3V0ZS5wYXJhbXM7CiAgICBnZXRSZXF1ZXN0KCIvc2NvcmVzL3VzZXJzIiwge2NpZDogdGhpcy5wYXJhbXMuY29udGVzdElkfSkudGhlbigocmVzKSA9PiB7CiAgICAgIHRoaXMuZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICB9KQogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uID0gW107CiAgICAgIGNvbnN0IHNlbmRlciA9IHRoaXMuJHN0b3JlLnN0YXRlLnVpZDsKICAgICAgdmFsLmZvckVhY2goKHZhbCkgPT4gewogICAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb24ucHVzaCh7cmVjaXBpZW50OiB2YWwudXNlcklkLCBzZW5kZXI6IHNlbmRlcn0pOwogICAgICB9KTsKICAgIH0sCiAgICBzZW5kKCkgewogICAgICBsZXQgbGVuZ3RoID0gdGhpcy5tdWx0aXBsZVNlbGVjdGlvbi5sZW5ndGgKICAgICAgaWYgKGxlbmd0aCAmJiB0aGlzLnRpdGxlLnRyaW0oKSAhPT0gJycgJiYgdGhpcy50ZXh0LnRyaW0oKSAhPT0gJycpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5tdWx0aXBsZVNlbGVjdGlvbltpXSwgJ3RpdGxlJywgdGhpcy50aXRsZSk7CiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5tdWx0aXBsZVNlbGVjdGlvbltpXSwgJ3RleHQnLCB0aGlzLnRleHQpOwogICAgICAgIH0KICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLm11bHRpcGxlU2VsZWN0aW9uKTsKICAgICAgICBwb3N0UmVxdWVzdCgiL21lc3NhZ2VzL3NhdmUiLCB0aGlzLm11bHRpcGxlU2VsZWN0aW9uKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhLmRhdGEpOwogICAgICAgICAgaWYgKHJlcy5kYXRhLmRhdGEpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLlj5HpgIHmiJDlip/jgIIiKQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5Y+R6YCB5aSx6LSl77yBIikKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoIuivt+WcqOW3puS+p+WLvumAieWtpueUn+aIluajgOa1i+agh+mimOWGheWuueaYr+WQpuS4uuepuu+8gSIpCiAgICAgIH0KICAgIH0sCiAgICBnbyhkYXRhKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICB0aGlzLnBhcmFtcy5uYW1lID0gZGF0YS5uYW1lOwogICAgICB0aGlzLnBhcmFtcy5zY29yZXNJZCA9IGRhdGEuc2NvcmVzSWQ7CiAgICAgIHRoaXMucGFyYW1zLnBob25lID0gZGF0YS5waG9uZTsKICAgICAgdGhpcy5wYXJhbXMuc2Nob29sID0gZGF0YS5zY2hvb2w7CiAgICAgIHRoaXMucGFyYW1zLnVzZXJJZCA9IGRhdGEudXNlcklkOwogICAgICB0aGlzLnBhcmFtcy5zdGF0ZSA9IGRhdGEuc3RhdGU7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMucGFyYW1zKTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdtYW5hZ2VtZW50LXNjb3JlJywgcGFyYW1zOiB0aGlzLnBhcmFtc30pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/layout/Main/Management/Message","sourcesContent":["<template>\n  <div>\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\" :offset=\"4\">\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span style=\"line-height: 28px;font-size: 20px\">发送消息请先选中</span>\n            <el-button style=\"float: right\" size=\"mini\" type=\"primary\" round @click=\"$router.push('/management')\">\n              返回\n            </el-button>\n          </div>\n          <el-table :data=\"data\" @selection-change=\"handleSelectionChange\" fit>\n            <el-table-column type=\"selection\"></el-table-column>\n            <el-table-column prop=\"name\" label=\"姓名\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"school\" label=\"学校\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"phone\" label=\"手机号\" align=\"center\"></el-table-column>\n            <el-table-column prop=\"state\" label=\"评审状态\" align=\"center\">\n              <template v-slot=\"scope\">\n                <el-tag :type=\"scope.row.state ? 'danger' : 'success'\" disable-transitions>\n                  {{ scope.row.state ? '已评审' : '未评审' }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column fixed=\"right\" label=\"操作\" width=\"100%\" align=\"center\">\n              <template v-slot=\"scope\">\n                <el-button type=\"text\" size=\"small\" @click=\"go(scope.row)\">\n                  {{ scope.row.state ? '查看' : '评审' }}\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-card>\n      </el-col>\n      <el-col :span=\"4\">\n        <el-card>\n          <div slot=\"header\" class=\"clearfix\">\n            <span style=\"line-height: 28px;font-size: 20px\">发送消息</span>\n          </div>\n          <el-form label-position=\"top\">\n            <el-form-item label=\"标题\" prop=\"title\">\n              <el-input placeholder=\"请输入标题\" v-model=\"title\" maxlength=\"20\" show-word-limit\n                        :rules=\"[{ required: true, message: '标题不能为空'}]\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"内容\" prop=\"text\">\n              <el-input type=\"textarea\" :rows=\"5\" placeholder=\"请输入内容\" v-model=\"text\"\n                        :rules=\"[{ required: true, message: '内容不能为空'}]\"></el-input>\n            </el-form-item>\n            <el-form-item style=\"float: right\">\n              <el-button type=\"primary\" round @click=\"send\">发送</el-button>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport {getRequest, postRequest} from \"@/utils/api\";\n\nexport default {\n  name: \"Message\",\n  data() {\n    return {\n      params: {},\n      // contestId:'',\n      // contestTitle:'',\n      data: [],\n      multipleSelection: [],\n      title: '',\n      text: ''\n    }\n  },\n  mounted() {\n    this.params = this.$route.params;\n    getRequest(\"/scores/users\", {cid: this.params.contestId}).then((res) => {\n      this.data = res.data.data;\n    })\n  },\n  methods: {\n    handleSelectionChange(val) {\n      this.multipleSelection = [];\n      const sender = this.$store.state.uid;\n      val.forEach((val) => {\n        this.multipleSelection.push({recipient: val.userId, sender: sender});\n      });\n    },\n    send() {\n      let length = this.multipleSelection.length\n      if (length && this.title.trim() !== '' && this.text.trim() !== '') {\n        for (let i = 0; i < length; i++) {\n          this.$set(this.multipleSelection[i], 'title', this.title);\n          this.$set(this.multipleSelection[i], 'text', this.text);\n        }\n        // console.log(this.multipleSelection);\n        postRequest(\"/messages/save\", this.multipleSelection).then((res) => {\n          console.log(res.data.data);\n          if (res.data.data) {\n            this.$message.success(\"发送成功。\")\n          } else {\n            this.$message.error(\"发送失败！\")\n          }\n        });\n      } else {\n        this.$message.warning(\"请在左侧勾选学生或检测标题内容是否为空！\")\n      }\n    },\n    go(data) {\n      // console.log(data);\n      this.params.name = data.name;\n      this.params.scoresId = data.scoresId;\n      this.params.phone = data.phone;\n      this.params.school = data.school;\n      this.params.userId = data.userId;\n      this.params.state = data.state;\n      // console.log(this.params);\n      this.$router.push({name: 'management-score', params: this.params})\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}